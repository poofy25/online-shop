import{u as g,j as c,a as e,r as u,F as p,b as S,Z as N,d as C,c as f,e as P,J as I}from"./index-800fbec0.js";const v="/online-shop/assets/emptyCartImage-e50ae3ed.png";function y(){const o=g();return c("div",{className:"emptyCartContainer",children:[e("img",{src:v}),e("p",{className:"emptyCartText",children:"You have no items in cart."}),e("p",{children:"Dilvin has many articles that are waiting for you!"}),e("button",{onClick:()=>{o("/catalog")},className:"goShoppingBtn",children:"Go Shopping"})]})}const D="/online-shop/assets/trashIcon-19b5cd10.png";function J(o){let l=g(),t=o.productData;const[s,d]=u.useState(t.amount),m=n=>{const i=JSON.parse(localStorage.getItem("cartProducts")).filter(h=>h.uniqueID!==n.uniqueID);localStorage.setItem("cartProducts",JSON.stringify(i)),o.updateLS(JSON.parse(localStorage.getItem("cartProducts")))},r=n=>{n.target.textContent==="-"?s-1>0?d(i=>i-1):m(t):n.target.textContent==="+"&&d(i=>i+1)};u.useEffect(()=>{d(t.amount)},[o.LSData]),u.useEffect(()=>{t={...t,amount:s};let n=JSON.parse(localStorage.getItem("cartProducts"));n[o.productIndex]=t,localStorage.setItem("cartProducts",JSON.stringify(n)),o.updateLS(JSON.parse(localStorage.getItem("cartProducts")))},[s]);const a=()=>{l(`/product/${t.id}`)};return c("div",{className:"productCartContainer",children:[e("img",{src:t.image,onClick:a}),c("div",{className:"cartProductDetails",children:[e("p",{className:"cartProductName",onClick:a,children:t.name}),e("button",{className:"cartProductTrashBtn",onClick:()=>{m(t)},children:e("img",{src:D})}),c("span",{className:"sizeAndColorContainer",children:[c("span",{className:"cartProductSize",children:[e("p",{children:"Size: "}),e("p",{children:t.size})]}),c("span",{className:"cartProductColor",children:[e("p",{children:"Color: "}),e("p",{children:t.color})]})]}),c("p",{className:"cartProductPrice",children:["$",(s*(t.discount?t.discount.price_after_discount:t.price)).toFixed(2),s>1?c("span",{children:["   |   $",t.discount?t.discount.price_after_discount:t.price," ea."]}):e(p,{})]}),c("div",{className:"productCountContainer",children:[e("button",{onClick:r,children:"-"}),e("div",{className:"productAmmount",children:s}),e("button",{onClick:r,children:"+"})]})]})]})}function k(){const[o]=S(f),l=g(),[t,s]=u.useState(JSON.parse(localStorage.getItem("cartProducts"))),d=()=>{let r=0;for(const a in t)r+=t[a].amount*(t[a].discount?t[a].discount.price_after_discount:t[a].price);return r.toFixed(2)},m=()=>{let r=0;for(const a in t)r+=t[a].amount;return r};return u.useEffect(()=>(localStorage.setItem("cartNotification",!1),document.querySelector(".navCartNotification").classList.remove("active"),()=>{if(o&&localStorage.getItem("cartProducts")!==JSON.stringify(t)){const r=N(C,`users/${o.uid}`);async function a(){const n={cartItems:JSON.parse(localStorage.getItem("cartProducts")),updatedAt:P()};try{await I(r,n,{merge:!0})}catch(i){console.error("Error adding document: ",i)}}a()}}),[]),JSON.parse(localStorage.getItem("cartProducts"))===null||JSON.parse(localStorage.getItem("cartProducts")).length===0?e(p,{children:e("div",{className:"websiteContent",children:e(y,{})})}):e(p,{children:e("div",{className:"websiteContent",children:c("div",{className:"cartPage",children:[e("p",{className:"cartPageHeader",children:"Your shopping cart"}),c("div",{className:"checkoutContainer",children:[c("p",{className:"checkoutItemsAmount",children:["Items: ",e("span",{children:m()})]}),c("p",{className:"checkoutAmount",children:["Subtotal: ",c("span",{children:["$",d()]})]}),e("button",{className:"checkoutBtn",onClick:()=>{l(o?"/checkout":"/signin")},children:"CHECKOUT"})]}),t.map((r,a)=>e(J,{productData:r,productIndex:a,updateLS:s,LSData:t},a))]})})})}export{k as default};
